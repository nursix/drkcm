(function(d,k,l){var h={version:"2.0.3",tipLocation:"bottom",nubPosition:"auto",scroll:!0,scrollSpeed:300,timer:0,autoStart:!1,startTimerOnClick:!0,startOffset:0,nextButton:!0,tipAnimation:"fade",pauseAfter:[],tipAnimationFadeSpeed:300,cookieMonster:!1,cookieName:"joyride",cookieDomain:!1,localStorage:!1,localStorageKey:"joyride",tipContainer:"body",modal:!1,expose:!1,postExposeCallback:d.noop,preRideCallback:d.noop,postRideCallback:d.noop,preStepCallback:d.noop,postStepCallback:d.noop,template:{link:'<a href="#close" class="joyride-close-tip">X</a>',
timer:'<div class="joyride-timer-indicator-wrap"><span class="joyride-timer-indicator"></span></div>',tip:'<div class="joyride-tip-guide"><span class="joyride-nub"></span></div>',wrapper:'<div class="joyride-content-wrapper" role="dialog"></div>',button:'<a href="#" class="joyride-next-tip"></a>',modal:'<div class="joyride-modal-bg"></div>',expose:'<div class="joyride-expose-wrapper"></div>',exposeCover:'<div class="joyride-expose-cover"></div>'}},m=m||!1,a={},e={init:function(b){return this.each(function(){d.isEmptyObject(a)?
(a=d.extend(!0,h,b),a.document=k.document,a.$document=d(a.document),a.$window=d(k),a.$content_el=d(this),a.$body=d(a.tipContainer),a.body_offset=d(a.tipContainer).position(),a.$tip_content=d("> li",a.$content_el),a.paused=!1,a.attempts=0,a.tipLocationPatterns={top:["bottom"],bottom:[],left:["right","top","bottom"],right:["left","top","bottom"]},e.jquery_check(),d.isFunction(d.cookie)||(a.cookieMonster=!1),a.cookieMonster&&d.cookie(a.cookieName)||a.localStorage&&e.support_localstorage()&&localStorage.getItem(a.localStorageKey)||
(a.$tip_content.each(function(c){e.create({$li:d(this),index:c})}),a.autoStart&&(!a.startTimerOnClick&&0<a.timer?(e.show("init"),e.startTimer()):e.show("init"))),a.$document.on("click.joyride",".joyride-next-tip, .joyride-modal-bg",function(c){c.preventDefault();1>a.$li.next().length?e.end():0<a.timer?(clearTimeout(a.automate),e.hide(),e.show(),e.startTimer()):(e.hide(),e.show())}),a.$document.on("click.joyride",".joyride-close-tip",function(c){c.preventDefault();e.end()}),a.$window.bind("resize.joyride",
function(c){a.$li&&(a.exposed&&0<a.exposed.length&&d(a.exposed).each(function(){var f=d(this);e.un_expose(f);e.expose(f)}),e.is_phone()?e.pos_phone():e.pos_default())})):e.restart()})},resume:function(){e.set_li();e.show()},nextTip:function(){1>a.$li.next().length?e.end():0<a.timer?(clearTimeout(a.automate),e.hide(),e.show(),e.startTimer()):(e.hide(),e.show())},tip_template:function(b){b.tip_class=b.tip_class||"";var c=d(a.template.tip).addClass(b.tip_class);var f=d.trim(d(b.li).html())+e.button_text(b.button_text)+
a.template.link+e.timer_instance(b.index);var g=d(a.template.wrapper);b.li.attr("data-aria-labelledby")&&g.attr("aria-labelledby",b.li.attr("data-aria-labelledby"));b.li.attr("data-aria-describedby")&&g.attr("aria-describedby",b.li.attr("data-aria-describedby"));c.append(g);c.first().attr("data-index",b.index);d(".joyride-content-wrapper",c).append(f);return c[0]},timer_instance:function(b){return 0===b&&a.startTimerOnClick&&0<a.timer||0===a.timer?"":e.outerHTML(d(a.template.timer)[0])},button_text:function(b){a.nextButton?
(b=d.trim(b)||"Next",b=e.outerHTML(d(a.template.button).append(b)[0])):b="";return b},create:function(b){var c=b.$li.attr("data-button")||b.$li.attr("data-text"),f=b.$li.attr("class");b=d(e.tip_template({tip_class:f,index:b.index,button_text:c,li:b.$li}));d(a.tipContainer).append(b)},show:function(b){var c={};if(a.$li===l||-1===d.inArray(a.$li.index(),a.pauseAfter))if(a.paused?a.paused=!1:e.set_li(b),a.attempts=0,a.$li.length&&0<a.$target.length){b&&(a.preRideCallback(a.$li.index(),a.$next_tip),a.modal&&
e.show_modal());a.preStepCallback(a.$li.index(),a.$next_tip);b=(a.$li.data("options")||":").split(";");var f=b.length;for(--f;0<=f;f--){var g=b[f].split(":");2===g.length&&(c[d.trim(g[0])]=d.trim(g[1]))}a.tipSettings=d.extend({},a,c);a.tipSettings.tipLocationPattern=a.tipLocationPatterns[a.tipSettings.tipLocation];a.modal&&a.expose&&e.expose();!/body/i.test(a.$target.selector)&&a.scroll&&e.scroll_to();e.is_phone()?e.pos_phone(!0):e.pos_default(!0);c=d(".joyride-timer-indicator",a.$next_tip);/pop/i.test(a.tipAnimation)?
(c.outerWidth(0),0<a.timer?(a.$next_tip.show(),c.animate({width:d(".joyride-timer-indicator-wrap",a.$next_tip).outerWidth()},a.timer)):a.$next_tip.show()):/fade/i.test(a.tipAnimation)&&(c.outerWidth(0),0<a.timer?(a.$next_tip.fadeIn(a.tipAnimationFadeSpeed),a.$next_tip.show(),c.animate({width:d(".joyride-timer-indicator-wrap",a.$next_tip).outerWidth()},a.timer)):a.$next_tip.fadeIn(a.tipAnimationFadeSpeed));a.$current_tip=a.$next_tip;d(".joyride-next-tip",a.$current_tip).focus();e.tabbable(a.$current_tip)}else a.$li&&
1>a.$target.length?e.show():e.end();else a.paused=!0},is_phone:function(){return m?m.mq("only screen and (max-width: 767px)"):767>a.$window.width()?!0:!1},support_localstorage:function(){return m?m.localstorage:!!k.localStorage},hide:function(){a.modal&&a.expose&&e.un_expose();a.modal||d(".joyride-modal-bg").hide();a.$current_tip.hide();a.postStepCallback(a.$li.index(),a.$current_tip)},set_li:function(b){b?(a.$li=a.$tip_content.eq(a.startOffset),e.set_next_tip(),a.$current_tip=a.$next_tip):(a.$li=
a.$li.next(),e.set_next_tip());e.set_target()},set_next_tip:function(){a.$next_tip=d(".joyride-tip-guide[data-index="+a.$li.index()+"]")},set_target:function(){var b=a.$li.attr("data-class"),c=a.$li.attr("data-id");a.$target=c?d(a.document.getElementById(c)):b?d("."+b).filter(":visible").first():d("body")},scroll_to:function(){var b=a.$window.height()/2;b=Math.ceil(a.$target.offset().top-b+a.$next_tip.outerHeight());d("html, body").stop().animate({scrollTop:b},a.scrollSpeed)},paused:function(){return-1===
d.inArray(a.$li.index()+1,a.pauseAfter)?!0:!1},destroy:function(){d.isEmptyObject(a)||a.$document.off(".joyride");d(k).off(".joyride");d(".joyride-close-tip, .joyride-next-tip, .joyride-modal-bg").off(".joyride");d(".joyride-tip-guide, .joyride-modal-bg").remove();clearTimeout(a.automate);a={}},restart:function(){a.autoStart?(e.hide(),a.$li=l,e.show("init")):(!a.startTimerOnClick&&0<a.timer?(e.show("init"),e.startTimer()):e.show("init"),a.autoStart=!0)},pos_default:function(b){a.$window.height();
a.$next_tip.offset();var c=d(".joyride-nub",a.$next_tip),f=Math.ceil(c.outerWidth()/2),g=Math.ceil(c.outerHeight()/2);if(b=b||!1)a.$next_tip.css("visibility","hidden"),a.$next_tip.show();/body/i.test(a.$target.selector)?a.$li.length&&e.pos_modal(c):(e.bottom()?(a.$next_tip.css({top:a.$target.offset().top+g+a.$target.outerHeight(),left:a.$target.offset().left}),/right/i.test(a.tipSettings.nubPosition)&&a.$next_tip.css("left",a.$target.offset().left-a.$next_tip.outerWidth()+a.$target.outerWidth()),
e.nub_position(c,a.tipSettings.nubPosition,"top")):e.top()?(a.$next_tip.css({top:a.$target.offset().top-a.$next_tip.outerHeight()-g,left:a.$target.offset().left}),e.nub_position(c,a.tipSettings.nubPosition,"bottom")):e.right()?(a.$next_tip.css({top:a.$target.offset().top,left:a.$target.outerWidth()+a.$target.offset().left+f}),e.nub_position(c,a.tipSettings.nubPosition,"left")):e.left()&&(a.$next_tip.css({top:a.$target.offset().top,left:a.$target.offset().left-a.$next_tip.outerWidth()-f}),e.nub_position(c,
a.tipSettings.nubPosition,"right")),!e.visible(e.corners(a.$next_tip))&&a.attempts<a.tipSettings.tipLocationPattern.length&&(c.removeClass("bottom").removeClass("top").removeClass("right").removeClass("left"),a.tipSettings.tipLocation=a.tipSettings.tipLocationPattern[a.attempts],a.attempts++,e.pos_default(!0)));b&&(a.$next_tip.hide(),a.$next_tip.css("visibility","visible"))},pos_phone:function(b){var c=a.$next_tip.outerHeight();a.$next_tip.offset();var f=a.$target.outerHeight(),g=d(".joyride-nub",
a.$next_tip),n=Math.ceil(g.outerHeight()/2);b=b||!1;g.removeClass("bottom").removeClass("top").removeClass("right").removeClass("left");b&&(a.$next_tip.css("visibility","hidden"),a.$next_tip.show());/body/i.test(a.$target.selector)?a.$li.length&&e.pos_modal(g):e.top()?(a.$next_tip.offset({top:a.$target.offset().top-c-n}),g.addClass("bottom")):(a.$next_tip.offset({top:a.$target.offset().top+f+n}),g.addClass("top"));b&&(a.$next_tip.hide(),a.$next_tip.css("visibility","visible"))},pos_modal:function(b){e.center();
b.hide();e.show_modal()},show_modal:function(){1>d(".joyride-modal-bg").length&&d("body").append(a.template.modal).show();/pop/i.test(a.tipAnimation)?d(".joyride-modal-bg").show():d(".joyride-modal-bg").fadeIn(a.tipAnimationFadeSpeed)},expose:function(){var b="expose-"+Math.floor(1E4*Math.random());if(0<arguments.length&&arguments[0]instanceof d)var c=arguments[0];else if(a.$target&&!/body/i.test(a.$target.selector))c=a.$target;else return!1;if(1>c.length)return k.console&&console.error("element not valid",
c),!1;var f=d(a.template.expose);a.$body.append(f);f.css({top:c.offset().top,left:c.offset().left,width:c.outerWidth(!0),height:c.outerHeight(!0)});var g=d(a.template.exposeCover);var n={zIndex:c.css("z-index"),position:c.css("position")};c.css("z-index",1*f.css("z-index")+1);"static"==n.position&&c.css("position","relative");c.data("expose-css",n);g.css({top:c.offset().top,left:c.offset().left,width:c.outerWidth(!0),height:c.outerHeight(!0)});a.$body.append(g);f.addClass(b);g.addClass(b);a.tipSettings.exposeClass&&
(f.addClass(a.tipSettings.exposeClass),g.addClass(a.tipSettings.exposeClass));c.data("expose",b);a.postExposeCallback(a.$li.index(),a.$next_tip,c);e.add_exposed(c)},un_expose:function(){var b=!1;if(0<arguments.length&&arguments[0]instanceof d)var c=arguments[0];else if(a.$target&&!/body/i.test(a.$target.selector))c=a.$target;else return!1;if(1>c.length)return k.console&&console.error("element not valid",c),!1;var f=c.data("expose");f=d("."+f);1<arguments.length&&(b=arguments[1]);!0===b?d(".joyride-expose-wrapper,.joyride-expose-cover").remove():
f.remove();b=c.data("expose-css");"auto"==b.zIndex?c.css("z-index",""):c.css("z-index",b.zIndex);b.position!=c.css("position")&&("static"==b.position?c.css("position",""):c.css("position",b.position));c.removeData("expose");c.removeData("expose-z-index");e.remove_exposed(c)},add_exposed:function(b){a.exposed=a.exposed||[];b instanceof d?a.exposed.push(b[0]):"string"==typeof b&&a.exposed.push(b)},remove_exposed:function(b){var c;b instanceof d?c=b[0]:"string"==typeof b&&(c=b);a.exposed=a.exposed||
[];for(b=0;b<a.exposed.length;b++)if(a.exposed[b]==c){a.exposed.splice(b,1);break}},center:function(){var b=a.$window;a.$next_tip.css({top:(b.height()-a.$next_tip.outerHeight())/2+b.scrollTop(),left:(b.width()-a.$next_tip.outerWidth())/2+b.scrollLeft()});return!0},bottom:function(){return/bottom/i.test(a.tipSettings.tipLocation)},top:function(){return/top/i.test(a.tipSettings.tipLocation)},right:function(){return/right/i.test(a.tipSettings.tipLocation)},left:function(){return/left/i.test(a.tipSettings.tipLocation)},
corners:function(b){var c=a.$window,f=c.height()/2;f=Math.ceil(a.$target.offset().top-f+a.$next_tip.outerHeight());var g=c.width()+c.scrollLeft(),n=c.height()+f,p=c.height()+c.scrollTop(),q=c.scrollTop();f<q&&(q=0>f?0:f);n>p&&(p=n);return[b.offset().top<q,g<b.offset().left+b.outerWidth(),p<b.offset().top+b.outerHeight(),c.scrollLeft()>b.offset().left]},visible:function(b){for(var c=b.length;c--;)if(b[c])return!1;return!0},nub_position:function(b,c,f){"auto"===c?b.addClass(f):b.addClass(c)},startTimer:function(){a.$li.length?
a.automate=setTimeout(function(){e.hide();e.show();e.startTimer()},a.timer):clearTimeout(a.automate)},end:function(){a.cookieMonster&&d.cookie(a.cookieName,"ridden",{expires:365,domain:a.cookieDomain});a.localStorage&&localStorage.setItem(a.localStorageKey,!0);0<a.timer&&clearTimeout(a.automate);a.modal&&a.expose&&e.un_expose();d(".joyride-modal-bg").hide();a.$current_tip.hide();a.postStepCallback(a.$li.index(),a.$current_tip);a.postRideCallback(a.$li.index(),a.$current_tip)},jquery_check:function(){return d.isFunction(d.fn.on)?
!0:(d.fn.on=function(b,c,f){return this.delegate(c,b,f)},d.fn.off=function(b,c,f){return this.undelegate(c,b,f)},!1)},outerHTML:function(b){return b.outerHTML||(new XMLSerializer).serializeToString(b)},version:function(){return a.version},tabbable:function(b){d(b).on("keydown",function(c){if(!c.isDefaultPrevented()&&c.keyCode&&27===c.keyCode)c.preventDefault(),e.end();else if(9===c.keyCode){var f=d(b).find(":tabbable"),g=f.filter(":first");f=f.filter(":last");c.target!==f[0]||c.shiftKey?c.target===
g[0]&&c.shiftKey&&(f.focus(1),c.preventDefault()):(g.focus(1),c.preventDefault())}})}};d.fn.joyride=function(b){if(e[b])return e[b].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof b&&b)d.error("Method "+b+" does not exist on jQuery.joyride");else return e.init.apply(this,arguments)}})(jQuery,this);
function pre_step_callback(d,k){$.each(pre_step_data,function(l,h){l=h[1];var m=h[2];if(d==h[0]){var a=$("#"+l+" thead th").map(function(){return $(this).text().toLowerCase()});a[0]="id";h=$("#"+l+" tbody tr").map(function(b){var c={};if(b==m)return $(this).find("td").each(function(f){f=a[f];c[f]="id"==f?$(this).find("a").attr("db_id"):$(this).text()}),c}).get();var e=$(k)[0].innerHTML;0<h.length&&$.each(h[0],function(b,c){e=e.replace(new RegExp("dt_"+b,"g"),c)});$($(k)[0]).html(e)}})}
function post_step_callback(d,k){$.each(post_step_data,function(l,h){l=h[1];if(d==h[0]){if(2<h.length){var m=h[3];h=$($("td:first a:first","#"+h[2]+" tbody tr")[m]).attr("db_id");l=l.replace(/dt_id/g,h)}window.location.href=l}})}function post_ride_callback(d,k){d={};d.completed=post_ride_data[0];d.tour_id=post_ride_data[1];$.ajax({type:"POST",url:S3.Ap.concat("/tour/guided_tour_finished"),data:d})}
$(document).ready(function(){var d=$("#prestep_data");0<d.length?(pre_step_data=$.parseJSON(d.val()),prestep_callback=pre_step_callback):prestep_callback=$.noop;d=$("#poststep_data");0<d.length?(post_step_data=$.parseJSON(d.val()),poststep_callback=post_step_callback):poststep_callback=$.noop;d=$("#postride_data");0<d.length?(post_ride_data=$.parseJSON(d.val()),postride_callback=post_ride_callback):postride_callback=$.noop;$("#joyrideID_1").joyride({autoStart:!0,preStepCallback:prestep_callback,postStepCallback:poststep_callback,
postRideCallback:post_ride_callback})});
