var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,d,b){a instanceof String&&(a=String(a));for(var f=a.length,e=0;e<f;e++){var t=a[e];if(d.call(b,t,e,a))return{i:e,v:t}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,d,b){if(a==Array.prototype||a==Object.prototype)return a;a[d]=b.value;return a};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var d=0;d<a.length;++d){var b=a[d];if(b&&b.Math==Math)return b}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,d){var b=$jscomp.propertyToPolyfillSymbol[d];if(null==b)return a[d];b=a[b];return void 0!==b?b:a[d]};
$jscomp.polyfill=function(a,d,b,f){d&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,d,b,f):$jscomp.polyfillUnisolated(a,d,b,f))};$jscomp.polyfillUnisolated=function(a,d,b,f){b=$jscomp.global;a=a.split(".");for(f=0;f<a.length-1;f++){var e=a[f];if(!(e in b))return;b=b[e]}a=a[a.length-1];f=b[a];d=d(f);d!=f&&null!=d&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:d})};
$jscomp.polyfillIsolated=function(a,d,b,f){var e=a.split(".");a=1===e.length;f=e[0];f=!a&&f in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var t=0;t<e.length-1;t++){var x=e[t];if(!(x in f))return;f=f[x]}e=e[e.length-1];b=$jscomp.IS_SYMBOL_NATIVE&&"es6"===b?f[e]:null;d=d(b);null!=d&&(a?$jscomp.defineProperty($jscomp.polyfills,e,{configurable:!0,writable:!0,value:d}):d!==b&&(void 0===$jscomp.propertyToPolyfillSymbol[e]&&(b=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[e]=$jscomp.IS_SYMBOL_NATIVE?
$jscomp.global.Symbol(e):$jscomp.POLYFILL_PREFIX+b+"$"+e),$jscomp.defineProperty(f,$jscomp.propertyToPolyfillSymbol[e],{configurable:!0,writable:!0,value:d})))};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(d,b){return $jscomp.findInternal(this,d,b).v}},"es6","es3");
(function(a,d){function b(c){c=c.find("[name=_formname]").val();if("undefined"!=typeof c){if("cap_alert"==c.substring(0,9))return"cap_alert";if("cap_info"==c.substring(0,8))return"cap_info"}return""}function f(){return 0<a(".cap_info_template_form").length}function e(c){return"cap_alert"==c?["codes","note","incidents"]:"cap_info"==c?"category event response_type urgency severity certainty audience event_code effective onset expires sender_name headline description instruction contact web parameter".split(" "):
[]}function t(c){function w(g,m){var l=b(c),n=e(l),u={};"undefined"==typeof m&&(m=!1);if(g)"cap_alert"==l?(v=g.$_cap_alert&&g.$_cap_alert[0]||{},u=a.parseJSON(v.template_settings)||{},a(".cap_alert_form").addClass("template_loaded")):"cap_info"==l&&(v=g.$_cap_info&&g.$_cap_info[0]||{},u={});else{var v={};u={}}a.each(n,function(y,p){try{var q=c.find("[name="+p+"]"),z=u.locked&&u.locked[p];switch(typeof v[p]){case "string":"restriction"==p?(q.val(v[p]||""),""!=q.val()&&h.show()):(k.show(),h.hide());
case "undefined":if(q.is(":text")||q.is("textarea")||q.is("select"))(m||z)&&q.val(v[p]||""),z?q.prop("disabled",!0).attr("title","This field is locked by the template"):q.prop("disabled",!1).attr("title","");break;case "object":var A=["scope","addresses","codes"];for(y=0;y<A.length;y++)p==A[y]&&q.val(v[p]["@value"]||"");"incidents"==p&&(m||z)&&(q.val(v[p]["@value"]||""),a("select#cap_alert_incidents").multiselect("refresh"))}}catch(B){s3_debug("ERROR",B)}})}function r(g,m,l){if(g){"undefined"==typeof l&&
(l="template");var n=new RegExp(".*\\"+S3.Ap+"\\/");n=(new String(self.location)).replace(n,"").split("?")[0].split("/")[0];g=[S3.Ap,n,l,g].join("/")+".s3json";a.ajax({url:g,type:"GET",dataType:"json",success:function(u){w(u,m)},error:function(u){alert("There was an unexpected error loading template data")}})}}var h=a("#cap_alert_restriction__row, #cap_alert_restriction__row1"),k=a("#cap_alert_addresses__row, #cap_alert_addresses__row1");"Restricted"==a("#cap_alert_scope").val()?(h.show(),k.hide()):
("Public"==a("#cap_alert_scope").val()||"Private"==a("#cap_alert_scope").val()?k.show():k.hide(),h.hide());a("#cap_alert_scope").change(function(){switch(a(this).val()){case "Public":h.hide();a("#cap_alert_restriction").val()&&a("#cap_alert_restriction").val("");k.show();break;case "Restricted":k.hide();a("#cap_alert_addresses").val()&&a("#cap_alert_addresses").val("");h.show();break;case "Private":h.hide();a("#cap_alert_restriction").val()&&a("#cap_alert_restriction").val("");k.show();break;case "":k.hide(),
h.hide()}});a("#cap_info_priority").change(function(){if(a(this).val()){var g=S3.cap_priorities,m=g.length;"Undefined"==a(this).find("option:selected").text()&&(a(this).css("border","2px solid gray"),c.find("[name=urgency]").val(""),c.find("[name=severity]").val(""),c.find("[name=certainty]").val(""));for(var l=0;l<m;l++)g[l][0]==a(this).find("option:selected").text()&&(c.find("[name=urgency]").val(g[l][1]),c.find("[name=severity]").val(g[l][2]),c.find("[name=certainty]").val(g[l][3]),a(this).css("border",
"2px solid #"+g[l][4]))}else a(this).css("border","1px solid gray")});c.find("[name=template_id]").change(function(){r(a(this).val(),!0)});"cap_alert"!=b(c)||0<a(".cap_template_form").length||r(c.find("[name=template_id]").val());"cap_info"!=b(c)||f()||r(c.find("[name=template_info_id]").val(),!1,"info");window.apply_temp=r}function x(c){function w(){try{return a.parseJSON(c.find("[name=template_settings]").val())||{}}catch(h){return s3_debug("Error occured parsing: ",c.find("[name=template_settings]").val()),
{}}}function r(h,k){var g="can_edit-"+h,m=a('<label for="'+g+'">'+(i18n.cap_locked||"Locked")+"</label>");g=a('<input type="checkbox" name="'+g+'"/>');g.change(function(){var n=w();n.locked=n.locked||{};n.locked[h]=a(this).is(":checked");c.find("[name=template_settings]").val(d.stringify(n))});var l=w();l.locked&&l.locked[h]&&g.prop("checked","checked");k.append(m);k.append(g)}c.find("[name=is_template]").prop("checked","checked");tablename=b(c);fields=e(tablename);c.find("tr").each(function(){var h=
a(this),k=h.attr("id");k&&k.match("__row$")&&(k=k.replace(tablename+"_","").replace("__row",""),h=h.find("td.w2p_fc")||h.find("td").eq(1),0<=fields.indexOf(k)&&r(k,h))})}var D=function(){a(".cap-clone-update").unbind(".cap").bind("click.cap",function(){C(a(this).attr("data"))})},C=function(c){var w=c.split("/")[0];(c=c.split("/").pop())&&a.ajax({url:S3.Ap.concat("/cap/alert/")+c+"/clone?msg_type="+w,success:function(r){window.location.href=S3.Ap.concat("/cap/alert/")+r.message},error:function(r,h,
k){console.log("UNAUTHORIZED"==k?i18n.gis_requires_login:r.responseText)},type:"POST",dataType:"json"})};window.fields=e;a(document).ready(function(){a("form").each(function(){""!==b(a(this))&&(t(a(this)),(0<a(".cap_template_form").length||f())&&x(a(this)))});D()})})(jQuery,JSON,void 0);
