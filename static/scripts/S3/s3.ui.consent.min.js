/*
 2019 (c) Sahana Software Foundation
 @license MIT

 requires jQuery 1.9.1+
 requires jQuery UI 1.10 widget factory
*/
(function(a,e){var f=0;a.widget("s3.consentQuestion",{options:{},_create:function(){this.id=f;f+=1;this.eventNamespace=".consentQuestion"},_init:function(){var b=a(this.element);this.input=a("#"+b.attr("id")+"-response");this.refresh()},_destroy:function(){a.Widget.prototype.destroy.call(this)},refresh:function(){this._unbindEvents();var b=a(this.element),d=this._deserialize();a(".consent-checkbox",b).each(function(){var c=a(this).data("code");c=d[c];c!==e&&a(this).prop("checked",c[1])});this.input.hasClass("invalidinput")&&
(b.addClass("invalidinput"),window.scrollTo(0,a(".invalidinput").first().offset().top));this._bindEvents()},_deserialize:function(){var b=this.input.val(),d={};if(b)try{d=JSON.parse(b)}catch(c){}return d},_serialize:function(){var b=a(this.element),d=this._deserialize();a(".consent-checkbox",b).each(function(){var c=a(this).data("code");c=d[c];c!==e&&(c[1]=a(this).prop("checked"))});this.input.val(JSON.stringify(d))},deselect:function(b){var d=a(this.element);a(".consent-checkbox",d).each(function(){var c=
a(this);c.data("code")==b&&c.prop("checked",!1)});this._serialize()},_bindEvents:function(){var b=a(this.element),d=this;b.on("change"+this.eventNamespace,".consent-checkbox",function(){a(".error_wrapper",b).remove();b.removeClass("invalidinput");d.input.removeClass("invalidinput");d._serialize()});return!0},_unbindEvents:function(){a(this.element).off(this.eventNamespace);return!0}})})(jQuery);
