(function(){function f(a){return!isNaN(parseFloat(a))&&isFinite(a)}function g(a){return function(b){a.val(b||"");"undefined"==typeof b&&a.trigger("focus")}}function p(a){var b=Math.abs(a);b=60*(b-parseInt(b,10));if(1E-10>Math.abs(b-Math.round(b)))b=Math.round(b),c=0;else{var c=60*(b-parseInt(b,10));1E-10>Math.abs(c-Math.round(c))&&(c=Math.round(c))}return{d:parseInt(a,10),m:parseInt(b,10),s:c}}function q(a){var b=$(".degrees",a).val()||0,c=$(".minutes",a).val()||0,d=$(".seconds",a).val()||0,k=g($(".degrees",
a)),l=g($(".minutes",a)),m=g($(".seconds",a)),r=g($(".decimal",a));a="gis_location_lat"==$(".decimal",a).attr("id");f(b)?(b=Number(b),Math.abs(b)>(a?90:180)?(alert(e.degrees[a?"lat":"lon"]),k()):f(c)?(c=Math.abs(c),60<c?(alert(e.minutes),l()):f(d)?(d=Math.abs(d),60<=d?(alert(e.seconds),m()):(b=(0>b?-1:1)*(Math.abs(b)+c/60+d/3600),Math.abs(b)>(a?90:180)?alert(e.decimal[a?"lat":"lon"]):(c=p(b),r(""+b),k(c.d||"0"),l(c.m||"0"),m(c.s||"0")))):(alert(h.seconds),m())):(alert(h.minutes),l())):(alert(h.degrees),
k())}function n(a){var b=$(".decimal",a),c=b.val(),d="gis_location_lat"==$(".decimal",a).attr("id");""!==c&&(f(c)?(c=Number(c),Math.abs(c)>(d?90:180)?(alert(e.decimal[d?"lat":"lon"]),b.trigger("focus")):(b=p(c),$(".degrees",a).val(b.d||"0"),$(".minutes",a).val(b.m||"0"),$(".seconds",a).val(b.s||"0"))):(alert(h.decimal),b.val("").trigger("focus")))}var h=i18n.gis_only_numbers,e=i18n.gis_range_error;$(".gis_coord_dms input").on("blur",function(){q($(this).parents(".gis_coord_wrap").eq(0))}).on("keypress",
function(a){13==a.which&&a.preventDefault()});$(function(){$(".gis_coord_decimal input").on("blur",function(){n($(this).parents(".gis_coord_wrap").eq(0))}).on("keypress",function(a){13==a.which&&a.preventDefault()});$(".gis_coord_switch_dms").on("click",function(a){$(".gis_coord_dms").show();$(".gis_coord_decimal").hide();$(".gis_coord_wrap").each(function(){n($(this))});a.preventDefault()});$(".gis_coord_switch_decimal").on("click",function(a){$(".gis_coord_decimal").show();$(".gis_coord_dms").hide();
$(".gis_coord_wrap").each(function(){q($(this))});a.preventDefault()});$(".gis_coord_wrap").each(function(){n($(this))})})})(jQuery);
