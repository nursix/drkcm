/*
 jQuery Color Animations v2.0pre
 http://jquery.org/

 Copyright 2011 John Resig
 Dual licensed under the MIT or GPL Version 2 licenses.
 http://jquery.org/license
*/
(function(l,F){function L(b,n,f){var e=ea[n.type]||{};if((n.empty||f)&&null==b)return null;if(n.def&&null==b)return n.def;b=e.floor?~~b:parseFloat(b);return null==b||isNaN(b)?n.def:e.mod?(b%=e.mod,0>b?e.mod+b:b):e.min>b?e.min:e.max<b?e.max:b}function z(b){var n=I(),f=n._rgba=[];b=b.toLowerCase();S(V,function(e,x){e=(e=x.re.exec(b))&&x.parse(e);var B=x.space||"rgba";x=J[B].cache;if(e)return e=n[B](e),n[x]=e[x],f=n._rgba=e._rgba,!1});if(0!==f.length)return 0===Math.max.apply(Math,f)&&l.extend(f,ca.transparent),
n;if(b=ca[b])return b}function Y(b,n,f){f=(f+1)%1;return 1>6*f?b+6*(n-b)*f:1>2*f?n:2>3*f?b+(n-b)*(2/3-f)*6:b}var Z=/^([\-+])=\s*(\d+\.?\d*)/,V=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(b){return[b[1],b[2],b[3],b[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)%\s*,\s*(\d+(?:\.\d+)?)%\s*,\s*(\d+(?:\.\d+)?)%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(b){return[2.55*b[1],2.55*b[2],2.55*b[3],b[4]]}},{re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,
parse:function(b){return[parseInt(b[1],16),parseInt(b[2],16),parseInt(b[3],16)]}},{re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/,parse:function(b){return[parseInt(b[1]+b[1],16),parseInt(b[2]+b[2],16),parseInt(b[3]+b[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)%\s*,\s*(\d+(?:\.\d+)?)%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(b){return[b[1],b[2]/100,b[3]/100,b[4]]}}],I=l.Color=function(b,n,f,e){return new l.Color.fn.parse(b,n,f,e)},J={rgba:{cache:"_rgba",props:{red:{idx:0,
type:"byte",empty:!0},green:{idx:1,type:"byte",empty:!0},blue:{idx:2,type:"byte",empty:!0},alpha:{idx:3,type:"percent",def:1}}},hsla:{cache:"_hsla",props:{hue:{idx:0,type:"degrees",empty:!0},saturation:{idx:1,type:"percent",empty:!0},lightness:{idx:2,type:"percent",empty:!0}}}},ea={"byte":{floor:!0,min:0,max:255},percent:{min:0,max:1},degrees:{mod:360,floor:!0}},fa=J.rgba.props,ba=I.support={},S=l.each;J.hsla.props.alpha=fa.alpha;I.fn=I.prototype={constructor:I,parse:function(b,n,f,e){if(b===F)return this._rgba=
[null,null,null,null],this;if(b instanceof l||b.nodeType)b=b instanceof l?b.css(n):l(b).css(n),n=F;var x=this,B=l.type(b),G=this._rgba=[];n!==F&&(b=[b,n,f,e],B="array");if("string"===B)return this.parse(z(b)||ca._default);if("array"===B)return S(fa,function(M,w){G[w.idx]=L(b[w.idx],w)}),this;if("object"===B)return b instanceof I?S(J,function(M,w){b[w.cache]&&(x[w.cache]=b[w.cache].slice())}):S(J,function(M,w){S(w.props,function(C,a){var g=w.cache;if(!x[g]&&w.to){if(null==b[C]||"alpha"===C)return;
x[g]=w.to(x._rgba)}x[g][a.idx]=L(b[C],a,!0)})}),this},is:function(b){var n=I(b),f=!0,e=this;S(J,function(x,B){var G=n[B.cache];if(G){var M=e[B.cache]||B.to&&B.to(e._rgba)||[];S(B.props,function(w,C){if(null!=G[C.idx])return f=G[C.idx]===M[C.idx]})}return f});return f},_space:function(){var b=[],n=this;S(J,function(f,e){n[e.cache]&&b.push(f)});return b.pop()},transition:function(b,n){var f=I(b);b=f._space();var e=J[b],x=this[e.cache]||e.to(this._rgba),B=x.slice();f=f[e.cache];S(e.props,function(G,
M){G=M.idx;var w=x[G],C=f[G],a=ea[M.type]||{};null!==C&&(null===w?B[G]=C:(a.mod&&(C-w>a.mod/2?w+=a.mod:w-C>a.mod/2&&(w-=a.mod)),B[M.idx]=L((C-w)*n+w,M)))});return this[b](B)},blend:function(b){if(1===this._rgba[3])return this;var n=this._rgba.slice(),f=n.pop(),e=I(b)._rgba;return I(l.map(n,function(x,B){return(1-f)*e[B]+f*x}))},toRgbaString:function(){var b="rgba(",n=l.map(this._rgba,function(f,e){return null==f?2<e?1:0:f});1===n[3]&&(n.pop(),b="rgb(");return b+n.join(",")+")"},toHslaString:function(){var b=
"hsla(",n=l.map(this.hsla(),function(f,e){null==f&&(f=2<e?1:0);e&&3>e&&(f=Math.round(100*f)+"%");return f});1===n[3]&&(n.pop(),b="hsl(");return b+n.join(",")+")"},toHexString:function(b){var n=this._rgba.slice(),f=n.pop();b&&n.push(~~(255*f));return"#"+l.map(n,function(e,x){e=(e||0).toString(16);return 1===e.length?"0"+e:e}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}};I.fn.parse.prototype=I.fn;J.hsla.to=function(b){if(null==b[0]||null==b[1]||null==b[2])return[null,
null,null,b[3]];var n=b[0]/255,f=b[1]/255,e=b[2]/255;b=b[3];var x=Math.max(n,f,e),B=Math.min(n,f,e),G=x-B,M=x+B,w=.5*M;return[Math.round(B===x?0:n===x?60*(f-e)/G+360:f===x?60*(e-n)/G+120:60*(n-f)/G+240)%360,0===w||1===w?w:.5>=w?G/M:G/(2-M),w,null==b?1:b]};J.hsla.from=function(b){if(null==b[0]||null==b[1]||null==b[2])return[null,null,null,b[3]];var n=b[0]/360,f=b[1],e=b[2];b=b[3];f=.5>=e?e*(1+f):e+f-e*f;e=2*e-f;return[Math.round(255*Y(e,f,n+1/3)),Math.round(255*Y(e,f,n)),Math.round(255*Y(e,f,n-1/3)),
b]};S(J,function(b,n){var f=n.props,e=n.cache,x=n.to,B=n.from;I.fn[b]=function(G){x&&!this[e]&&(this[e]=x(this._rgba));if(G===F)return this[e].slice();var M=l.type(G),w="array"===M||"object"===M?G:arguments,C=this[e].slice();S(f,function(g,D){g=w["object"===M?g:D.idx];null==g&&(g=C[D.idx]);C[D.idx]=L(g,D)});if(B){var a=I(B(C));a[e]=C;return a}return I(C)};S(f,function(G,M){I.fn[G]||(I.fn[G]=function(w){var C=l.type(w),a="alpha"===G?this._hsla?"hsla":"rgba":b,g=this[a](),D=g[M.idx];if("undefined"===
C)return D;"function"===C&&(w=w.call(this,D),C=l.type(w));if(null==w&&M.empty)return this;"string"===C&&(C=Z.exec(w))&&(w=D+parseFloat(C[2])*("+"===C[1]?1:-1));g[M.idx]=w;return this[a](g)})})});S("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color outlineColor".split(" "),function(b,n){l.cssHooks[n]={set:function(f,e){var x;if("string"!==l.type(e)||(x=z(e))){e=I(x||e);if(!ba.rgba&&1!==e._rgba[3]){var B="backgroundColor"===n?f.parentNode:f;do x=l.curCSS(B,"backgroundColor");
while((""===x||"transparent"===x)&&(B=B.parentNode)&&B.style);e=e.blend(x&&"transparent"!==x?x:"_default")}e=e.toRgbaString()}f.style[n]=e}};l.fx.step[n]=function(f){f.colorInit||(f.start=I(f.elem,n),f.end=I(f.end),f.colorInit=!0);l.cssHooks[n].set(f.elem,f.start.transition(f.end,f.pos))}});l(function(){var b=document.createElement("div").style;b.cssText="background-color:rgba(1,1,1,.5)";ba.rgba=-1<b.backgroundColor.indexOf("rgba")});var ca=l.Color.names={aqua:"#00ffff",azure:"#f0ffff",beige:"#f5f5dc",
black:"#000000",blue:"#0000ff",brown:"#a52a2a",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkviolet:"#9400d3",fuchsia:"#ff00ff",gold:"#ffd700",green:"#008000",indigo:"#4b0082",khaki:"#f0e68c",lightblue:"#add8e6",lightcyan:"#e0ffff",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightyellow:"#ffffe0",
lime:"#00ff00",magenta:"#ff00ff",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#ffa500",pink:"#ffc0cb",purple:"#800080",violet:"#800080",red:"#ff0000",silver:"#c0c0c0",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}})(jQuery);
(function(l){l.Jcrop=function(F,L){function z(c){return Math.round(c)+"px"}function Y(c){c=l(c).offset();return[c.left,c.top]}function Z(c){return[c.pageX-pa[0],c.pageY-pa[1]]}function V(c){"object"!==typeof c&&(c={});a=l.extend(a,c);l.each(["onChange","onSelect","onRelease","onDblClick"],function(t,q){"function"!==typeof a[q]&&(a[q]=function(){})})}function I(c,t,q){pa=Y(H);ja.setCursor("move"===c?c:c+"-resize");if("move"===c)return ja.activateHandlers(ea(t),b,q);t=N.getFixed();var A=fa(c),h=N.getCorner(fa(A));
N.setPressed(N.getCorner(A));N.setCurrent(h);ja.activateHandlers(J(c,t),b,q)}function J(c,t){return function(q){if(a.aspectRatio)switch(c){case "e":q[1]=t.y+1;break;case "w":q[1]=t.y+1;break;case "n":q[0]=t.x+1;break;case "s":q[0]=t.x+1}else switch(c){case "e":q[1]=t.y2;break;case "w":q[1]=t.y2;break;case "n":q[0]=t.x2;break;case "s":q[0]=t.x2}N.setCurrent(q);E.update()}}function ea(c){var t=c;Ba.watchKeys();return function(q){N.moveOffset([q[0]-t[0],q[1]-t[1]]);t=q;E.update()}}function fa(c){switch(c){case "n":return"sw";
case "s":return"nw";case "e":return"nw";case "w":return"ne";case "ne":return"sw";case "nw":return"se";case "se":return"nw";case "sw":return"ne"}}function ba(c){return function(t){if(a.disabled||"move"===c&&!a.allowMove)return!1;pa=Y(H);qa=!0;I(c,Z(t));t.stopPropagation();t.preventDefault();return!1}}function S(c,t,q){var A=c.width(),h=c.height();A>t&&0<t&&(A=t,h=t/c.width()*c.height());h>q&&0<q&&(h=q,A=q/c.height()*c.width());W=c.width()/A;aa=c.height()/h;c.width(A).height(h)}function ca(c){return{x:c.x*
W,y:c.y*aa,x2:c.x2*W,y2:c.y2*aa,w:c.w*W,h:c.h*aa}}function b(c){c=N.getFixed();c.w>a.minSelect[0]&&c.h>a.minSelect[1]?(E.enableHandles(),E.done()):E.release();ja.setCursor(a.allowSelect?"crosshair":"default")}function n(c){if(a.disabled||!a.allowSelect)return!1;qa=!0;pa=Y(H);E.disableHandles();ja.setCursor("crosshair");var t=Z(c);N.setPressed(t);E.update();ja.activateHandlers(f,b,"touch"===c.type.substring(0,5));Ba.watchKeys();c.stopPropagation();c.preventDefault();return!1}function f(c){N.setCurrent(c);
E.update()}function e(){var c=l("<div></div>").addClass(a.baseClass+"-tracker");D&&c.css({opacity:0,backgroundColor:"white"});return c}function x(c){B([c[0]/W,c[1]/aa,c[2]/W,c[3]/aa]);a.onSelect.call(ha,ca(N.getFixed()));E.enableHandles()}function B(c){N.setPressed([c[0],c[1]]);N.setCurrent([c[2],c[3]]);E.update()}function G(){a.disabled=!0;E.disableHandles();E.setCursor("default");ja.setCursor("default")}function M(){a.disabled=!1;C()}function w(c,t,q){t=t||a.bgColor;a.bgFade&&l.fx.step.hasOwnProperty("backgroundColor")&&
a.fadeTime&&!q?c.animate({backgroundColor:t},{queue:!1,duration:a.fadeTime}):c.css("backgroundColor",t)}function C(c){a.allowResize?c?E.enableOnly():E.enableHandles():E.disableHandles();ja.setCursor(a.allowSelect?"crosshair":"default");E.setCursor(a.allowMove?"move":"default");a.hasOwnProperty("trueSize")&&(W=a.trueSize[0]/O,aa=a.trueSize[1]/K);a.hasOwnProperty("setSelect")&&(x(a.setSelect),E.done(),delete a.setSelect);ma.refresh();a.bgColor!=Da&&(w(a.shade?ma.getShades():ka,a.shade?a.shadeColor||
a.bgColor:a.bgColor),Da=a.bgColor);va!=a.bgOpacity&&(va=a.bgOpacity,a.shade?ma.refresh():E.setBgOpacity(va));wa=a.maxSize[0]||0;xa=a.maxSize[1]||0;ya=a.minSize[0]||0;za=a.minSize[1]||0;a.hasOwnProperty("outerImage")&&(H.attr("src",a.outerImage),delete a.outerImage);E.refresh()}var a=l.extend({},l.Jcrop.defaults),g=navigator.userAgent.toLowerCase(),D=/msie/.test(g),Q=/msie [1-6]\./.test(g);"object"!==typeof F&&(F=l(F)[0]);"object"!==typeof L&&(L={});V(L);L={border:"none",visibility:"visible",margin:0,
padding:0,position:"absolute",top:0,left:0};var y=l(F);g=!0;if("IMG"==F.tagName){if(0!=y[0].width&&0!=y[0].height)y.width(y[0].width),y.height(y[0].height);else{var ra=new Image;ra.src=y[0].src;y.width(ra.width);y.height(ra.height)}var H=y.clone().removeAttr("id").css(L).show();H.width(y.width());H.height(y.height());y.after(H).hide()}else H=y.css(L).show(),g=!1,null===a.shade&&(a.shade=!0);S(H,a.boxWidth,a.boxHeight);var O=H.width(),K=H.height(),ka=l("<div />").width(O).height(K).addClass(a.baseClass+
"-holder").css({position:"relative",backgroundColor:a.bgColor}).insertAfter(y).append(H);a.addClass&&ka.addClass(a.addClass);var na=l("<div />"),Aa=l("<div />").width("100%").height("100%").css({zIndex:310,position:"absolute",overflow:"hidden"}),sa=l("<div />").width("100%").height("100%").css("zIndex",320),ta=l("<div />").css({position:"absolute",zIndex:600}).dblclick(function(){var c=N.getFixed();a.onDblClick.call(ha,c)}).insertBefore(H).append(Aa,sa);g&&(na=l("<img />").attr("src",H.attr("src")).css(L).width(O).height(K),
Aa.append(na));Q&&ta.css({overflowY:"hidden"});var ua=a.boundary,oa=e().width(O+2*ua).height(K+2*ua).css({position:"absolute",top:z(-ua),left:z(-ua),zIndex:290}).mousedown(n),Da=a.bgColor,va=a.bgOpacity,wa,xa,ya,za,W,aa,qa,Ca,Ea;var pa=Y(H);var ia=function(){function c(){var q={},A=["touchstart","touchmove","touchend"],h=document.createElement("div"),m;try{for(m=0;m<A.length;m++){var v=A[m];v="on"+v;var r=v in h;r||(h.setAttribute(v,"return;"),r="function"==typeof h[v]);q[A[m]]=r}return q.touchstart&&
q.touchend&&q.touchmove}catch(X){return!1}}var t=!0===a.touchSupport||!1===a.touchSupport?a.touchSupport:c();return{createDragger:function(q){return function(A){if(a.disabled||"move"===q&&!a.allowMove)return!1;pa=Y(H);qa=!0;I(q,Z(ia.cfilter(A)),!0);A.stopPropagation();A.preventDefault();return!1}},newSelection:function(q){return n(ia.cfilter(q))},cfilter:function(q){q.pageX=q.originalEvent.changedTouches[0].pageX;q.pageY=q.originalEvent.changedTouches[0].pageY;return q},isSupported:c,support:t}}(),
N=function(){function c(){if(!a.aspectRatio){var d=v-h,u=r-m;wa&&Math.abs(d)>wa&&(v=0<d?h+wa:h-wa);xa&&Math.abs(u)>xa&&(r=0<u?m+xa:m-xa);za/aa&&Math.abs(u)<za/aa&&(r=0<u?m+za/aa:m-za/aa);ya/W&&Math.abs(d)<ya/W&&(v=0<d?h+ya/W:h-ya/W);0>h&&(v-=h,h-=h);0>m&&(r-=m,m-=m);0>v&&(h-=v,v-=v);0>r&&(m-=r,r-=r);v>O&&(d=v-O,h-=d,v-=d);r>K&&(d=r-K,m-=d,r-=d);h>O&&(d=h-K,r-=d,m-=d);m>K&&(d=m-K,r-=d,m-=d);return A(q(h,m,v,r))}d=a.aspectRatio;u=a.minSize[0]/W;var R=a.maxSize[0]/W,P=v-h,da=r-m,p=Math.abs(P),k=Math.abs(da);
0===R&&(R=10*O);p/k<d?(p=r,k*=d,k=0>P?h-k:k+h,0>k?(k=0,p=Math.abs((k-h)/d),p=0>da?m-p:p+m):k>O&&(k=O,p=Math.abs((k-h)/d),p=0>da?m-p:p+m)):(k=v,p/=d,p=0>da?m-p:m+p,0>p?(p=0,k=Math.abs((p-m)*d),k=0>P?h-k:k+h):p>K&&(p=K,k=Math.abs(p-m)*d,k=0>P?h-k:k+h));k>h?(k-h<u?k=h+u:k-h>R&&(k=h+R),p=p>m?m+(k-h)/d:m-(k-h)/d):k<h&&(h-k<u?k=h-u:h-k>R&&(k=h-R),p=p>m?m+(h-k)/d:m-(h-k)/d);0>k?(h-=k,k=0):k>O&&(h-=k-O,k=O);0>p?(m-=p,p=0):p>K&&(m-=p-K,p=K);return A(q(h,m,k,p))}function t(d){0>d[0]&&(d[0]=0);0>d[1]&&(d[1]=
0);d[0]>O&&(d[0]=O);d[1]>K&&(d[1]=K);return[Math.round(d[0]),Math.round(d[1])]}function q(d,u,R,P){var da=d,p=R,k=u,T=P;R<d&&(da=R,p=d);P<u&&(k=P,T=u);return[da,k,p,T]}function A(d){return{x:d[0],y:d[1],x2:d[2],y2:d[3],w:d[2]-d[0],h:d[3]-d[1]}}var h=0,m=0,v=0,r=0,X,U;return{flipCoords:q,setPressed:function(d){d=t(d);v=h=d[0];r=m=d[1]},setCurrent:function(d){d=t(d);X=d[0]-v;U=d[1]-r;v=d[0];r=d[1]},getOffset:function(){return[X,U]},moveOffset:function(d){var u=d[0];d=d[1];0>h+u&&(u-=u+h);0>m+d&&(d-=
d+m);K<r+d&&(d+=K-(r+d));O<v+u&&(u+=O-(v+u));h+=u;v+=u;m+=d;r+=d},getCorner:function(d){var u=c();switch(d){case "ne":return[u.x2,u.y];case "nw":return[u.x,u.y];case "se":return[u.x2,u.y2];case "sw":return[u.x,u.y2]}},getFixed:c}}(),ma=function(){function c(){return t(N.getFixed())}function t(u){d.top.css({left:z(u.x),width:z(u.w),height:z(u.y)});d.bottom.css({top:z(u.y2),left:z(u.x),width:z(u.w),height:z(K-u.y2)});d.right.css({left:z(u.x2),width:z(O-u.x2)});d.left.css({width:z(u.x)})}function q(){return l("<div />").css({position:"absolute",
backgroundColor:a.shadeColor||a.bgColor}).appendTo(U)}function A(){X||(X=!0,U.insertBefore(H),c(),E.setBgOpacity(1,0,1),na.hide(),h(a.shadeColor||a.bgColor,1),E.isAwake()?v(a.bgOpacity,1):v(1,1))}function h(u,R){w(r(),u,R)}function m(){X&&(U.remove(),na.show(),X=!1,E.isAwake()?E.setBgOpacity(a.bgOpacity,1,1):(E.setBgOpacity(1,1,1),E.disableHandles()),w(ka,0,1))}function v(u,R){X&&(a.bgFade&&!R?U.animate({opacity:1-u},{queue:!1,duration:a.fadeTime}):U.css({opacity:1-u}))}function r(){return U.children()}
var X=!1,U=l("<div />").css({position:"absolute",zIndex:240,opacity:0}),d={top:q(),left:q().height(K),right:q().height(K),bottom:q()};return{update:c,updateRaw:t,getShades:r,setBgColor:h,enable:A,disable:m,resize:function(u,R){d.left.css({height:z(R)});d.right.css({height:z(R)})},refresh:function(){a.shade?A():m();E.isAwake()&&v(a.bgOpacity)},opacity:v}}(),E=function(){function c(p,k){k=l("<div />").mousedown(ba(p)).css({cursor:p+"-resize",position:"absolute",zIndex:k}).addClass("ord-"+p);ia.support&&
k.bind("touchstart.jcrop",ia.createDragger(p));sa.append(k);return k}function t(p){var k;for(k=0;k<p.length;k++)c(p[k],R++).addClass("jcrop-dragbar")}function q(p){var k;for(k=0;k<p.length;k++){switch(p[k]){case "n":var T="hline";break;case "s":T="hline bottom";break;case "e":T="vline right";break;case "w":T="vline"}var la=T;la=l("<div />").css({position:"absolute",opacity:a.borderOpacity}).addClass(a.baseClass+"-"+la);Aa.append(la)}}function A(p){var k;for(k=0;k<p.length;k++){var T=a.handleSize,
la=c(p[k],R++).css({opacity:a.handleOpacity}).addClass(a.baseClass+"-handle");T&&la.width(T).height(T)}}function h(){var p=N.getFixed();N.setPressed([p.x,p.y]);N.setCurrent([p.x2,p.y2]);m()}function m(p){if(u)return v(p)}function v(p){var k=N.getFixed(),T=k.h;ta.width(Math.round(k.w)).height(Math.round(T));T=k.x;var la=k.y;a.shade||na.css({top:z(-la),left:z(-T)});ta.css({top:z(la),left:z(T)});a.shade&&ma.updateRaw(k);u||(ta.show(),a.shade?ma.opacity(va):r(va,!0),u=!0);p?a.onSelect.call(ha,ca(k)):
a.onChange.call(ha,ca(k))}function r(p,k,T){if(u||k)a.bgFade&&!T?H.animate({opacity:p},{queue:!1,duration:a.fadeTime}):H.css("opacity",p)}function X(){P=!0;if(a.allowResize)return sa.show(),!0}function U(){P=!1;sa.hide()}function d(p){p?(Ca=!0,U()):(Ca=!1,X())}var u,R=370,P=!1;a.dragEdges&&l.isArray(a.createDragbars)&&t(a.createDragbars);l.isArray(a.createHandles)&&A(a.createHandles);a.drawBorders&&l.isArray(a.createBorders)&&q(a.createBorders);l(document).bind("touchstart.jcrop-ios",function(p){l(p.currentTarget).hasClass("jcrop-tracker")&&
p.stopPropagation()});var da=e().mousedown(ba("move")).css({cursor:"move",position:"absolute",zIndex:360});ia.support&&da.bind("touchstart.jcrop",ia.createDragger("move"));Aa.append(da);U();return{updateVisible:m,update:v,release:function(){U();ta.hide();a.shade?ma.opacity(1):r(1);u=!1;a.onRelease.call(ha)},refresh:h,isAwake:function(){return u},setCursor:function(p){da.css("cursor",p)},enableHandles:X,enableOnly:function(){P=!0},showHandles:function(){P&&sa.show()},disableHandles:U,animMode:d,setBgOpacity:r,
done:function(){d(!1);h()}}}(),ja=function(){function c(r){h(Z(r));return!1}function t(r){r.preventDefault();r.stopPropagation();qa&&(qa=!1,m(Z(r)),E.isAwake()&&a.onSelect.call(ha,ca(N.getFixed())),oa.css({zIndex:290}),l(document).unbind(".jcrop"),h=function(){},m=function(){});return!1}function q(r){h(Z(ia.cfilter(r)));return!1}function A(r){return t(ia.cfilter(r))}var h=function(){},m=function(){},v=a.trackDocument;v||oa.mousemove(c).mouseup(t).mouseout(t);H.before(oa);return{activateHandlers:function(r,
X,U){qa=!0;h=r;m=X;oa.css({zIndex:450});U?l(document).bind("touchmove.jcrop",q).bind("touchend.jcrop",A):v&&l(document).bind("mousemove.jcrop",c).bind("mouseup.jcrop",t);return!1},setCursor:function(r){oa.css("cursor",r)}}}(),Ba=function(){function c(m){A.hide()}function t(m,v,r){a.allowMove&&(N.moveOffset([v,r]),E.updateVisible(!0));m.preventDefault();m.stopPropagation()}function q(m){if(m.ctrlKey||m.metaKey)return!0;var v=(Ea=m.shiftKey?!0:!1)?10:1;switch(m.keyCode){case 37:t(m,-v,0);break;case 39:t(m,
v,0);break;case 38:t(m,0,-v);break;case 40:t(m,0,v);break;case 27:a.allowSelect&&E.release();break;case 9:return!0}return!1}var A=l('<input type="radio" />').css({position:"fixed",left:"-120px",width:"12px"}).addClass("jcrop-keymgr"),h=l("<div />").css({position:"absolute",overflow:"hidden"}).append(A);a.keySupport&&(A.keydown(q).blur(c),Q||!a.fixedSupport?(A.css({position:"absolute",left:"-20px"}),h.append(A).insertBefore(H)):A.insertBefore(H));return{watchKeys:function(){a.keySupport&&(A.show(),
A.focus())}}}();ia.support&&oa.bind("touchstart.jcrop",ia.newSelection);sa.hide();C(!0);var ha={setImage:function(c,t){E.release();G();var q=new Image;q.onload=function(){var A=q.height,h=a.boxWidth,m=a.boxHeight;H.width(q.width).height(A);H.attr("src",c);na.attr("src",c);S(H,h,m);O=H.width();K=H.height();na.width(O).height(K);oa.width(O+2*ua).height(K+2*ua);ka.width(O).height(K);ma.resize(O,K);M();"function"===typeof t&&t.call(ha)};q.src=c},animateTo:function(c,t){var q=c[0]/W,A=c[1]/aa,h=c[2]/W,
m=c[3]/aa;if(!Ca){c=N.flipCoords(q,A,h,m);var v=N.getFixed(),r=[v.x,v.y,v.x2,v.y2],X=a.animationDelay,U=c[0]-r[0],d=c[1]-r[1],u=c[2]-r[2],R=c[3]-r[3],P=0,da=a.swingSpeed;q=r[0];A=r[1];h=r[2];m=r[3];E.animMode(!0);var p=function(){return function(){P+=(100-P)/da;r[0]=Math.round(q+P/100*U);r[1]=Math.round(A+P/100*d);r[2]=Math.round(h+P/100*u);r[3]=Math.round(m+P/100*R);99.8<=P&&(P=100);100>P?(B(r),window.setTimeout(p,X)):(E.done(),E.animMode(!1),"function"===typeof t&&t.call(ha))}}();window.setTimeout(p,
X)}},setSelect:x,setOptions:function(c){V(c);C()},tellSelect:function(){return ca(N.getFixed())},tellScaled:function(){return N.getFixed()},setClass:function(c){ka.removeClass().addClass(a.baseClass+"-holder").addClass(c)},disable:G,enable:M,cancel:function(){E.done();ja.activateHandlers(null,null)},release:E.release,destroy:function(){ka.remove();y.show();y.css("visibility","visible");l(F).removeData("Jcrop")},focus:Ba.watchKeys,getBounds:function(){return[O*W,K*aa]},getWidgetSize:function(){return[O,
K]},getScaleFactor:function(){return[W,aa]},getOptions:function(){return a},ui:{holder:ka,selection:ta}};D&&ka.bind("selectstart",function(){return!1});y.data("Jcrop",ha);return ha};l.fn.Jcrop=function(F,L){var z;this.each(function(){if(l(this).data("Jcrop")){if("api"===F)return l(this).data("Jcrop");l(this).data("Jcrop").setOptions(F)}else"IMG"==this.tagName?l.Jcrop.Loader(this,function(){l(this).css({display:"block",visibility:"hidden"});z=l.Jcrop(this,F);l.isFunction(L)&&L.call(z)}):(l(this).css({display:"block",
visibility:"hidden"}),z=l.Jcrop(this,F),l.isFunction(L)&&L.call(z))});return this};l.Jcrop.Loader=function(F,L,z){function Y(){V.complete?(Z.unbind(".jcloader"),l.isFunction(L)&&L.call(V)):window.setTimeout(Y,50)}var Z=l(F),V=Z[0];Z.bind("load.jcloader",Y).bind("error.jcloader",function(I){Z.unbind(".jcloader");l.isFunction(z)&&z.call(V)});V.complete&&l.isFunction(L)&&(Z.unbind(".jcloader"),L.call(V))};l.Jcrop.defaults={allowSelect:!0,allowMove:!0,allowResize:!0,trackDocument:!0,baseClass:"jcrop",
addClass:null,bgColor:"black",bgOpacity:.6,bgFade:!1,borderOpacity:.4,handleOpacity:.5,handleSize:null,aspectRatio:0,keySupport:!0,createHandles:"n s e w nw ne se sw".split(" "),createDragbars:["n","s","e","w"],createBorders:["n","s","e","w"],drawBorders:!0,dragEdges:!0,fixedSupport:!0,touchSupport:null,shade:null,boxWidth:0,boxHeight:0,boundary:2,fadeTime:400,animationDelay:20,swingSpeed:3,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){},onDblClick:function(){},
onRelease:function(){}}})(jQuery);
$(function(){var l="png PNG jpg JPG jpeg JPEG".split(" "),F,L=$(".imagecrop-canvas"),z=L[0];if(void 0!=z){var Y=z.width;heightLimit=z.height;toScale=!0;if(0==Y||0==heightLimit)toScale=!1,Y=heightLimit=600;var Z=function(g){g=g.type.split("/");var D=g[0];F=g[g.length-1];if("image"==D&&-1!=$.inArray(F,l))return F="png"==F||"PNG"==F?"png":"jpeg",!0},V,I=function(g){g.stopPropagation();g.preventDefault();g.target.className="imagecrop-drag";"dragover"==g.type&&(g.target.className="imagecrop-drag hover")},
J,ea,fa,ba=new Image,S=function(g){var D;ba.src=g;ba.onload=function(){var Q=[Y,heightLimit],y=[ba.width,ba.height];y[0]>Q[0]&&(V=Q[0]/y[0],y[0]*=V,y[1]*=V);y[1]>Q[1]&&(V=Q[1]/y[1],y[0]*=V,y[1]*=V);y[0]=Math.floor(y[0]);y[1]=Math.floor(y[1]);ea=y;z.width=ea[0];z.height=ea[1];z.getContext("2d").drawImage(ba,0,0,ea[0],ea[1]);D=z.toDataURL("image/"+F);toScale?$(".imagecrop-data").val(fa+";"+D):$(".imagecrop-data").val(fa+";"+g);$("#uploaded-image").attr({src:D,style:"display: block"});$("#select-crop-btn").css({display:"inline"});
$("hr").attr({style:"display:block"})}},ca=$("#upload-title"),b=$("#upload-container");ca.on("click",function(g){b.slideDown("fast",function(){ca.html(i18n.upload_image)})});var n=function(g){J&&J.destroy();setTimeout(function(){b.slideUp("fast",function(){ca.html("<a>"+i18n.upload_new_image+"</a>")})},500);var D=new FileReader,Q=(g.target.files||g.originalEvent.dataTransfer.files)[0];fa=Q.name;C=g;"drop"==g.type&&I(g);g=$(".imagecrop-upload");Z(Q)?(D.onload=function(y){S(y.target.result)},D.readAsDataURL(Q)):
alert(i18n.invalid_image+"\n"+i18n.supported_image_formats+": png, jpeg or jpg");g.val("")},f=$("#select-crop-btn"),e=$("#crop-btn"),x=$("#remove-btn"),B=$('input[name="imagecrop-points"]'),G=function(g){J.release();J.disable();e.css({display:"none"});x.css({display:"none"});f.css({display:"inline"})};f.on("click",function(g){J.enable();var D=J.getBounds();g=D[0]/2;var Q=D[1]/2,y=D[0]/4;D=D[1]/4;J.animateTo([g-y,Q-D,g+y,Q+D]);f.css({display:"none"});e.css({display:"inline"});x.css({display:"inline"})});
e.on("click",function(g){var D=$(".jcrop-holder");g=parseInt(D.css("width").split("px")[0]);var Q=parseInt(D.css("height").split("px")[0]);D=ba.width/g;Q=ba.height/Q;g=B.val().split(",");var y=g[0],ra=g[1],H=g[3];g=Math.round((g[2]-y)*D);Q=Math.round((H-ra)*Q);J.destroy();G(C);L.attr({width:g,height:Q});z.getContext("2d").drawImage(ba,Math.round(y*D),Math.round(ra*D),g,Q,0,0,g,Q);g=z.toDataURL("image/"+F);S(g)});x.on("click",G);var M=function(g){B.val(g.x+","+g.y+","+g.x2+","+g.y2)};$("#uploaded-image").on("load",
function(g){g=$(this);J&&(J.destroy(),G(C));g.Jcrop({onChange:M,opacity:.2,bgFade:!0,bgColor:"black",addClass:"jcrop-light"},function(){J=this;J.getBounds();J.ui.selection.addClass("jcrop-selection");J.disable()})});var w=$(".imagecrop-data").attr("value");var C=document.createEvent("Event");var a=new Image;a.src=w;a.onload=function(){L.attr({width:a.width,height:a.height});z.getContext("2d").drawImage(a,0,0,a.width,a.height);var g=w.split(".");F=g[g.length-1];"jpg"==F&&(F="jpeg");fa="upload."+F;
g=z.toDataURL("image/"+F);S(g)};$(".imagecrop-drag").on("dragover",I).on("dragleave",I).on("drop",n);$(".imagecrop-upload").on("change",n)}});
